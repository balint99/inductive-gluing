
----------------------------------------------
-- Bool
----------------------------------------------

-- STT, non-dependent eliminator

data PBool : Tm âˆ™ Bool â†’ Set where
  Ptrue :  PBool true
  Pfalse : PBool false

indPBool : âˆ€ {i} (P : âˆ€ {t} â†’ PBool t â†’ Set i)
         â†’ P Ptrue â†’ P Pfalse
         â†’ âˆ€ {t}(tâ‚š : PBool t) â†’ P tâ‚š
indPBool P uâ‚š vâ‚š Ptrue  = uâ‚š
indPBool P uâ‚š vâ‚š Pfalse = vâ‚š

recPBool : âˆ€ {i} (A : Tm âˆ™ Bool â†’ Set i)
         â†’ A true â†’ A false
         â†’ âˆ€ {t} â†’ PBool t â†’ A t
recPBool A uâ‚š vâ‚š tâ‚š = indPBool (Î» {t} _ â†’ A t) uâ‚š vâ‚š tâ‚š

Bool-Prec : âˆ€ {i A} (Aâ‚š : Tm âˆ™ A â†’ Set i)
            {t : Tm âˆ™ Bool}{u v : Tm âˆ™ A}
          â†’ PBool t â†’ Aâ‚š u â†’ Aâ‚š v â†’ Aâ‚š (if t u v)
Bool-Prec Aâ‚š {t}{u}{v} tâ‚š uâ‚š vâ‚š = recPBool (Î» t â†’ Aâ‚š (if t u v)) uâ‚š vâ‚š tâ‚š

if : âˆ€ {Î“ A} â†’ Tm Î“ Bool â†’ Tm Î“ A â†’ Tm Î“ A â†’ Tm Î“ A
if true  u v = u
if false u v = v
(if t u v)[Ïƒ] = if (t[Ïƒ]) (u[Ïƒ]) (v[Ïƒ])

ifâ‚š : âˆ€ {Î“ A t u v}{Î“â‚š : Sub âˆ™ Î“ â†’ Set}{Aâ‚š : Tm âˆ™ A â†’ Set}
    â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ PBool (t[Î½]))
    â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Aâ‚š (u[Î½]))
    â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Aâ‚š (v[Î½]))
    â†’ âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Aâ‚š (if (t[Î½]) (u[Î½]) (v[Î½]))
ifâ‚š = Î» { {Aâ‚š = Aâ‚š} tâ‚š uâ‚š vâ‚š Î³â‚š â†’ Bool-Prec Aâ‚š (tâ‚š Î³â‚š) (uâ‚š Î³â‚š) (vâ‚š Î³â‚š) }

-- DTT, non-dependent eliminator

data PBool : Tm âˆ™ Bool â†’ Set where
  Ptrue :  PBool true
  Pfalse : PBool false

indPBool : âˆ€ {i} (P : âˆ€ {t} â†’ PBool t â†’ Set i)
         â†’ P Ptrue â†’ P Pfalse
         â†’ âˆ€ {t}(tâ‚š : PBool t) â†’ P tâ‚š
indPBool P uâ‚š vâ‚š Ptrue  = uâ‚š
indPBool P uâ‚š vâ‚š Pfalse = vâ‚š

recPBool : âˆ€ {i} (A : Tm âˆ™ Bool â†’ Set i)
         â†’ A true â†’ A false
         â†’ âˆ€ {t} â†’ PBool t â†’ A t
recPBool A uâ‚š vâ‚š tâ‚š = indPBool (Î» {t} _ â†’ A t) uâ‚š vâ‚š tâ‚š

Bool-Prec : âˆ€ {i A} (Aâ‚š : Tm âˆ™ A â†’ Set i)
            {t : Tm âˆ™ Bool}{u v : Tm âˆ™ A}
          â†’ PBool t â†’ Aâ‚š u â†’ Aâ‚š v â†’ Aâ‚š (if t u v)
Bool-Prec Aâ‚š {t}{u}{v} tâ‚š uâ‚š vâ‚š = recPBool (Î» t â†’ Aâ‚š (if t u v)) uâ‚š vâ‚š tâ‚š

if : âˆ€ {Î“ A} â†’ Tm Î“ Bool â†’ Tm Î“ A â†’ Tm Î“ A â†’ Tm Î“ A
if true  u v = u
if false u v = v
(if t u v)[Ïƒ] = if (t[Ïƒ]) (u[Ïƒ]) (v[Ïƒ])

Boolâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ Bool â†’ Set
Boolâ‚š = Î» _ â†’ PBool

ifâ‚š : âˆ€ {i Î“ A t u v}{Î“â‚š : Sub âˆ™ Î“ â†’ Set}{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
    â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PBool (t[Î½]))
    â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Aâ‚š Î³â‚š (u[Î½]))
    â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Aâ‚š Î³â‚š (v[Î½]))
    â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Aâ‚š Î³â‚š (if (t[Î½]) (u[Î½]) (v[Î½]))
ifâ‚š = Î» { {Aâ‚š = Aâ‚š} tâ‚š uâ‚š vâ‚š Î³â‚š â†’ Bool-Prec (Aâ‚š Î³â‚š) (tâ‚š Î³â‚š) (uâ‚š Î³â‚š) (vâ‚š Î³â‚š) }

-- DTT, dependent eliminator

data PBool : Tm âˆ™ Bool â†’ Set where
  Ptrue :  PBool true
  Pfalse : PBool false

indPBool : âˆ€ {i} (P : âˆ€ {t} â†’ PBool t â†’ Set i)
         â†’ P Ptrue â†’ P Pfalse
         â†’ âˆ€ {t}(tâ‚š : PBool t) â†’ P tâ‚š
indPBool P uâ‚š vâ‚š Ptrue  = uâ‚š
indPBool P uâ‚š vâ‚š Pfalse = vâ‚š

Bool-Prec : âˆ€ {i}{C : Ty (âˆ™ â–· Bool)}(Câ‚š : âˆ€ {t} â†’ PBool t â†’ Tm âˆ™ (C[id, t]) â†’ Set i)
            {t : Tm âˆ™ Bool}{u : Tm âˆ™ (C[id, true])}{v : Tm âˆ™ (C[id, false])}
          â†’ (tâ‚š : PBool t)
          â†’ Câ‚š Ptrue u
          â†’ Câ‚š Pfalse v
          â†’ Câ‚š tâ‚š (if C t u v)
Bool-Prec Câ‚š {t}{u}{v} tâ‚š uâ‚š vâ‚š = indPBool (Î» {t} tâ‚š â†’ Câ‚š tâ‚š (if C t u v)) uâ‚š vâ‚š tâ‚š

if : âˆ€ {Î“}(C : Ty (Î“ â–· Bool)}
   â†’ (t : Tm Î“ Bool)
   â†’ Tm Î“ (C[id, true])
   â†’ Tm Î“ (C[id, false])
   â†’ Tm Î“ (C[id, t])
if true  u v = u
if false u v = v
(if C t u v)[Ïƒ] = if (C[Ïƒâº]) (t[Ïƒ]) (u[Ïƒ]) (v[Ïƒ])

Boolâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ Bool â†’ Set
Boolâ‚š = Î» _ â†’ PBool

ifâ‚š : âˆ€ {i Î“ C t u v}{Î“â‚š : Sub âˆ™ Î“ â†’ Set}{Câ‚š : âˆ€ {Î½} â†’ Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ PBool (q[Î½])) â†’ Tm âˆ™ (C[Î½]) â†’ Set i}
    â†’ (tâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PBool (t[Î½]))
    â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, Ptrue) (u[Î½]))
    â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, Pfalse) (v[Î½]))
    â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, tâ‚š Î³â‚š) (if (C[Î½âº]) (t[Î½]) (u[Î½]) (v[Î½]))
ifâ‚š = Î» { {Câ‚š = Câ‚š} tâ‚š uâ‚š vâ‚š {Î½} Î³â‚š â†’ Bool-Prec {C = C[Î½âº]} (Î» {t} tâ‚š â†’ Câ‚š {Î½, t} (Î³â‚š, tâ‚š)) (tâ‚š Î³â‚š) (uâ‚š Î³â‚š) (vâ‚š Î³â‚š) }

----------------------------------------------
-- +
----------------------------------------------

-- STT, non-dependent eliminator

data _P+_ {i j A B}(Aâ‚š : Tm âˆ™ A â†’ Set i)(Bâ‚š : Tm âˆ™ B â†’ Set j)
     : Tm âˆ™ (A + B) â†’ Set (i âŠ” j) where
  Pinl : âˆ€ {u} â†’ Aâ‚š u â†’ (Aâ‚š P+ Bâ‚š) (inl u)
  Pinr : âˆ€ {v} â†’ Bâ‚š v â†’ (Aâ‚š P+ Bâ‚š) (inr v)

indP+ : âˆ€ {i j k A B}{Aâ‚š : Tm âˆ™ A â†’ Set i}{Bâ‚š : Tm âˆ™ B â†’ Set j}
        (P : âˆ€ {t} â†’ (Aâ‚š P+ Bâ‚š) t â†’ Set k)
      â†’ (âˆ€ {u}(uâ‚š : Aâ‚š u) â†’ P (Pinl uâ‚š))
      â†’ (âˆ€ {v}(vâ‚š : Bâ‚š v) â†’ P (Pinr vâ‚š))
      â†’ âˆ€ {t}(tâ‚š : (Aâ‚š P+ Bâ‚š) t) â†’ P tâ‚š
indP+ P f g (Pinl uâ‚š) = f uâ‚š
indP+ P f g (Pinr vâ‚š) = g vâ‚š

recP+ : âˆ€ {i j k A B}{Aâ‚š : Tm âˆ™ A â†’ Set i}{Bâ‚š : Tm âˆ™ B â†’ Set j}
      	(C : Tm âˆ™ (A + B) â†’ Set i)
      â†’ (âˆ€ {u} â†’ Aâ‚š u â†’ C (inl u))
      â†’ (âˆ€ {v} â†’ Bâ‚š v â†’ C (inr v))
      â†’ âˆ€ {t} â†’ (Aâ‚š P+ Bâ‚š) t â†’ C t
recP+ A uâ‚š vâ‚š tâ‚š = indP+ (Î» {t} _ â†’ C t) uâ‚š vâ‚š tâ‚š

+-Prec : âˆ€ {i j k A B C}
         {Aâ‚š : Tm âˆ™ A â†’ Set i}{Bâ‚š : Tm âˆ™ B â†’ Set j}(Câ‚š : Tm âˆ™ C â†’ Set i)
         {u : Tm (âˆ™ â–· A) C}{v : Tm (âˆ™ â–· B) C}{t : Tm âˆ™ (A + B)}
       â†’ (âˆ€ {a} â†’ Aâ‚š a â†’ Câ‚š (u[id, a]))
       â†’ (âˆ€ {b} â†’ Bâ‚š b â†’ Câ‚š (v[id, b]))
       â†’ (Aâ‚š P+ Bâ‚š) t â†’ Câ‚š (case u v t)
+-Prec Câ‚š {u}{v} f g tâ‚š = recP+ (Î» t â†’ Câ‚š (case u v t)) f g tâ‚š

case : âˆ€ {Î“ A B C} â†’ Tm (Î“ â–· A) C â†’ Tm (Î“ â–· B) C â†’ Tm Î“ (A + B) â†’ Tm Î“ C
case u v (inl a) = u[id, a]
case u v (inr b) = v[id, b]
(case u v t)[Ïƒ] = case (u[Ïƒâº]) (v[Ïƒâº]) (t[Ïƒ])

_+â‚š_ : âˆ€ {A B} â†’ (Tm âˆ™ A â†’ Set) â†’ (Tm âˆ™ B â†’ Set) â†’ Tm âˆ™ (A + B) â†’ Set
Aâ‚š +â‚š Bâ‚š = Aâ‚š P+ Bâ‚š

caseâ‚š : âˆ€ {Î“ A B C}{Î“â‚š : Sub âˆ™ Î“ â†’ Set}
      	{Aâ‚š : Tm âˆ™ A â†’ Set}{Bâ‚š : Tm âˆ™ B â†’ Set}{Câ‚š : Tm âˆ™ C â†’ Set}
	{u : Tm (Î“ â–· A) C}{v : Tm (Î“ â–· B) C}{t : Tm Î“ (A + B)}
      â†’ (âˆ€ {Î½} â†’ Î“â‚š (p âˆ˜ Î½) Ã— Aâ‚š (q[Î½]) â†’ Câ‚š (u[Î½]))
      â†’ (âˆ€ {Î½} â†’ Î“â‚š (p âˆ˜ Î½) Ã— Bâ‚š (q[Î½]) â†’ Câ‚š (v[Î½]))
      â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ (Aâ‚š P+ Bâ‚š) (t[Î½]))
      â†’ âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Câ‚š (case (u[Î½âº]) (v[Î½âº]) (t[Î½]))
caseâ‚š {Câ‚š = Câ‚š} uâ‚š vâ‚š tâ‚š Î³â‚š = +-Prec Câ‚š (Î» aâ‚š â†’ uâ‚š (Î³â‚š, aâ‚š)) (Î» bâ‚š â†’ vâ‚š (Î³â‚š, bâ‚š)) (tâ‚š Î³â‚š)

-- DTT, non-dependent eliminator

data _P+_ {i j A B}(Aâ‚š : Tm âˆ™ A â†’ Set i)(Bâ‚š : Tm âˆ™ B â†’ Set j)
     : Tm âˆ™ (A + B) â†’ Set (i âŠ” j) where
  Pinl : âˆ€ {u} â†’ Aâ‚š u â†’ (Aâ‚š P+ Bâ‚š) (inl u)
  Pinr : âˆ€ {v} â†’ Bâ‚š v â†’ (Aâ‚š P+ Bâ‚š) (inr v)

indP+ : âˆ€ {i j k A B}{Aâ‚š : Tm âˆ™ A â†’ Set i}{Bâ‚š : Tm âˆ™ B â†’ Set j}
        (P : âˆ€ {t} â†’ (Aâ‚š P+ Bâ‚š) t â†’ Set k)
      â†’ (âˆ€ {u}(uâ‚š : Aâ‚š u) â†’ P (Pinl uâ‚š))
      â†’ (âˆ€ {v}(vâ‚š : Bâ‚š v) â†’ P (Pinr vâ‚š))
      â†’ âˆ€ {t}(tâ‚š : (Aâ‚š P+ Bâ‚š) t) â†’ P tâ‚š
indP+ P f g (Pinl uâ‚š) = f uâ‚š
indP+ P f g (Pinr vâ‚š) = g vâ‚š

recP+ : âˆ€ {i j k A B}{Aâ‚š : Tm âˆ™ A â†’ Set i}{Bâ‚š : Tm âˆ™ B â†’ Set j}
      	(C : Tm âˆ™ (A + B) â†’ Set i)
      â†’ (âˆ€ {u} â†’ Aâ‚š u â†’ C (inl u))
      â†’ (âˆ€ {v} â†’ Bâ‚š v â†’ C (inr v))
      â†’ âˆ€ {t} â†’ (Aâ‚š P+ Bâ‚š) t â†’ C t
recP+ A uâ‚š vâ‚š tâ‚š = indP+ (Î» {t} _ â†’ C t) uâ‚š vâ‚š tâ‚š

+-Prec : âˆ€ {i j k A B C}
         {Aâ‚š : Tm âˆ™ A â†’ Set i}{Bâ‚š : Tm âˆ™ B â†’ Set j}(Câ‚š : Tm âˆ™ C â†’ Set i)
         {u : Tm (âˆ™ â–· A) (C[p])}{v : Tm (âˆ™ â–· B) (C[p])}{t : Tm âˆ™ (A + B)}
       â†’ (âˆ€ {a} â†’ Aâ‚š a â†’ Câ‚š (u[id, a]))
       â†’ (âˆ€ {b} â†’ Bâ‚š b â†’ Câ‚š (v[id, b]))
       â†’ (Aâ‚š P+ Bâ‚š) t â†’ Câ‚š (case u v t)
+-Prec Câ‚š {u}{v} f g tâ‚š = recP+ (Î» t â†’ Câ‚š (case u v t)) f g tâ‚š

case : âˆ€ {Î“ A B C} â†’ Tm (Î“ â–· A) (C[p]) â†’ Tm (Î“ â–· B) (C[p]) â†’ Tm Î“ (A + B) â†’ Tm Î“ C
case u v (inl a) = u[id, a]
case u v (inr b) = v[id, b]
(case u v t)[Ïƒ] = case (u[Ïƒâº]) (v[Ïƒâº]) (t[Ïƒ])

_+â‚š_ : âˆ€ {A B}
     â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i)
     â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (B[Î½]) â†’ Set j)
     â†’ âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½] + B[Î½]) â†’ Set (i âŠ” j)
Aâ‚š +â‚š Bâ‚š = Î» Î³â‚š â†’ Aâ‚š Î³â‚š P+ Bâ‚š Î³â‚š

caseâ‚š : âˆ€ {Î“ A B C u v t}{Î“â‚š : Sub âˆ™ Î“ â†’ Set a}
      	{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
	{Bâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (B[Î½]) â†’ Set j}
	{Câ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (C[Î½]) â†’ Set k}
      â†’ (âˆ€ {Î½}(Î³aâ‚š : Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ Aâ‚š Î³â‚š (q[Î½]))) â†’ Câ‚š (projâ‚ Î³aâ‚š) (u[Î½]))
      â†’ (âˆ€ {Î½}(Î³bâ‚š : Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ Bâ‚š Î³â‚š (q[Î½]))) â†’ Câ‚š (projâ‚ Î³bâ‚š) (v[Î½]))
      â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ (Aâ‚š Î³â‚š P+ Bâ‚š Î³â‚š) (t[Î½]))
      â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š Î³â‚š (case (u[Î½âº]) (v[Î½âº]) (t[Î½]))
caseâ‚š {Câ‚š = Câ‚š} uâ‚š vâ‚š tâ‚š Î³â‚š = +-Prec (Câ‚š Î³â‚š) (Î» aâ‚š â†’ uâ‚š (Î³â‚š, aâ‚š)) (Î» bâ‚š â†’ vâ‚š (Î³â‚š, bâ‚š)) (tâ‚š Î³â‚š)

-- DTT, dependent eliminator

data _P+_ {i j A B}(Aâ‚š : Tm âˆ™ A â†’ Set i)(Bâ‚š : Tm âˆ™ B â†’ Set j)
     : Tm âˆ™ (A + B) â†’ Set (i âŠ” j) where
  Pinl : âˆ€ {u} â†’ Aâ‚š u â†’ (Aâ‚š P+ Bâ‚š) (inl u)
  Pinr : âˆ€ {v} â†’ Bâ‚š v â†’ (Aâ‚š P+ Bâ‚š) (inr v)

indP+ : âˆ€ {i j k A B}{Aâ‚š : Tm âˆ™ A â†’ Set i}{Bâ‚š : Tm âˆ™ B â†’ Set j}
        (P : âˆ€ {t} â†’ (Aâ‚š P+ Bâ‚š) t â†’ Set k)
      â†’ (âˆ€ {u}(uâ‚š : Aâ‚š u) â†’ P (Pinl uâ‚š))
      â†’ (âˆ€ {v}(vâ‚š : Bâ‚š v) â†’ P (Pinr vâ‚š))
      â†’ âˆ€ {t}(tâ‚š : (Aâ‚š P+ Bâ‚š) t) â†’ P tâ‚š
indP+ P f g (Pinl uâ‚š) = f uâ‚š
indP+ P f g (Pinr vâ‚š) = g vâ‚š

+-Prec : âˆ€ {i j k A B}{C : Ty (âˆ™ â–· A + B)}
         {Aâ‚š : Tm âˆ™ A â†’ Set i}{Bâ‚š : Tm âˆ™ B â†’ Set j}
	 (Câ‚š : âˆ€ {t} â†’ (Aâ‚š P+ Bâ‚š) t â†’ Tm âˆ™ (C[id, t]) â†’ Set k)
         {u : Tm (âˆ™ â–· A) (C[p, inl 0])}{v : Tm (âˆ™ â–· B) (C[p, inr 0])}
	 {t : Tm âˆ™ (A + B)}
       â†’ (âˆ€ {a}(aâ‚š : Aâ‚š a) â†’ Câ‚š (Pinl aâ‚š) (u[id, a]))
       â†’ (âˆ€ {b}(bâ‚š : Bâ‚š b) â†’ Câ‚š (Pinr bâ‚š) (v[id, b]))
       â†’ (tâ‚š : (Aâ‚š P+ Bâ‚š) t) â†’ Câ‚š tâ‚š (case C u v t)
+-Prec Câ‚š {u}{v} f g tâ‚š = indP+ (Î» {t} tâ‚š â†’ Câ‚š tâ‚š (case C u v t)) uâ‚š vâ‚š tâ‚š

inl : âˆ€ {Î“ A B} â†’ Tm Î“ A â†’ Tm Î“ (A + B)
inr : âˆ€ {Î“ A B} â†’ Tm Î“ B â†’ Tm Î“ (A + B)

case : âˆ€ {Î“ A B}(C : Ty (Î“ â–· A + B))
     â†’ Tm (Î“ â–· A) (C[p, inl 0])
     â†’ Tm (Î“ â–· B) (C[p, inr 0])
     â†’ (t : Tm Î“ (A + B))
     â†’ Tm Î“ (C[id, t])
case C u v (inl a) = u[id, a]
case C u v (inr b) = v[id, b]
(case C u v t)[Ïƒ] = case (C[Ïƒâº]) (u[Ïƒâº]) (v[Ïƒâº]) (t[Ïƒ])

_+â‚š_ : âˆ€ {A B}
     â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i)
     â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (B[Î½]) â†’ Set j)
     â†’ âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½] + B[Î½]) â†’ Set (i âŠ” j)
Aâ‚š +â‚š Bâ‚š = Î» Î³â‚š â†’ Aâ‚š Î³â‚š P+ Bâ‚š Î³â‚š

inlâ‚š : âˆ€ {Î“ A B u}{Î“â‚š : Sub âˆ™ Î“ â†’ Set a}
       {Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
       {Bâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (B[Î½]) â†’ Set j}
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Aâ‚š Î³â‚š (u[Î½]))
     â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ (Aâ‚š Î³â‚š P+ Bâ‚š Î³â‚š) (inl (u[Î½]))
inlâ‚š uâ‚š Î³â‚š = Pinl (uâ‚š Î³â‚š)

inlâ‚š : âˆ€ {Î“ A B v}{Î“â‚š : Sub âˆ™ Î“ â†’ Set a}
       {Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
       {Bâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (B[Î½]) â†’ Set j}
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Bâ‚š Î³â‚š (v[Î½]))
     â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ (Aâ‚š Î³â‚š P+ Bâ‚š Î³â‚š) (inr (v[Î½]))
inlâ‚š vâ‚š Î³â‚š = Pinr (vâ‚š Î³â‚š)

caseâ‚š : âˆ€ {Î“ A B C u v t}{Î“â‚š : Sub âˆ™ Î“ â†’ Set a}
      	{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
	{Bâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (B[Î½]) â†’ Set j}
	{Câ‚š : âˆ€ {Î½} â†’ Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ (Aâ‚š Î³â‚š P+ Bâ‚š Î³â‚š) (q[Î½]))
	      	    â†’ Tm âˆ™ (C[Î½]) â†’ Set k}
      â†’ (âˆ€ {Î½}(Î³aâ‚š : Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ Aâ‚š Î³â‚š (q[Î½])))
         â†’ Câ‚š (projâ‚ Î³aâ‚š, Pinl (projâ‚‚ Î³aâ‚š)) (u[Î½]))
      â†’ (âˆ€ {Î½}(Î³bâ‚š : Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ Bâ‚š Î³â‚š (q[Î½])))
         â†’ Câ‚š (projâ‚ Î³bâ‚š, Pinr (projâ‚‚ Î³bâ‚š)) (v[Î½]))
      â†’ (tâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ (Aâ‚š Î³â‚š P+ Bâ‚š Î³â‚š) (t[Î½]))
      â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, tâ‚š Î³â‚š) (case (C[Î½âº]) (u[Î½âº]) (v[Î½âº]) (t[Î½]))
caseâ‚š {Câ‚š = Câ‚š} uâ‚š vâ‚š tâ‚š {Î½} Î³â‚š = +-Prec {Aâ‚š Î³â‚š}{Bâ‚š Î³â‚š}(Î» {t} tâ‚š â†’ Câ‚š {Î½, t} (Î³â‚š, tâ‚š))
  (Î» aâ‚š â†’ uâ‚š (Î³â‚š, aâ‚š)) (Î» bâ‚š â†’ vâ‚š (Î³â‚š, bâ‚š)) (tâ‚š Î³â‚š)

----------------------------------------------
-- Nat
----------------------------------------------

-- STT, non-dependent eliminator

data PNat : Tm âˆ™ Nat â†’ Set where
  Pzero : PNat zero
  Psuc  : âˆ€ {t} â†’ PNat t â†’ PNat (suc t)

indPNat : âˆ€ {i}(P : âˆ€ {t} â†’ PNat t â†’ Set i)
	â†’ P Pzero
	â†’ (âˆ€ {t}{tâ‚š : PNat t} â†’ P tâ‚š â†’ P (Psuc tâ‚š))
	â†’ âˆ€ {t}(tâ‚š : PNat t) â†’ P tâ‚š
indPNat P uâ‚š vâ‚š Pzero     = uâ‚š
indPNat P uâ‚š vâ‚š (Psuc tâ‚š) = vâ‚š (indPNat P uâ‚š vâ‚š tâ‚š)

recPNat : âˆ€ {i}(C : Tm âˆ™ Nat â†’ Set i)
	â†’ C zero
	â†’ (âˆ€ {t} â†’ C t â†’ C (suc t))
	â†’ âˆ€ {t} â†’ PNat t â†’ C t
recPNat C uâ‚š vâ‚š tâ‚š = indPNat (Î» {t} _ â†’ C t) uâ‚š (Î» {t} _ â†’ vâ‚š t) tâ‚š

Nat-Prec : âˆ€ {i C}(Câ‚š : Tm âˆ™ C â†’ Set i)
	   {u : Tm âˆ™ C}{v : Tm (âˆ™ â–· C) C}{t : Tm âˆ™ Nat}
	 â†’ Câ‚š u
	 â†’ (âˆ€ {c} â†’ Câ‚š c â†’ Câ‚š (v[id, c]))
	 â†’ PNat t â†’ Câ‚š (rec u v t)
Nat-Prec Câ‚š {u}{v} uâ‚š vâ‚š tâ‚š = recPNat (Î» t â†’ Câ‚š (rec u v t)) uâ‚š vâ‚š tâ‚š

rec : âˆ€ {Î“ C} â†’ Tm Î“ C â†’ Tm (Î“ â–· C) C â†’ Tm Î“ Nat â†’ Tm Î“ C
rec u v zero    = u
rec u v (suc t) = v[id, rec u v t]
(rec u v t)[Ïƒ] = rec (u[Ïƒ]) (v[Ïƒâº]) (t[Ïƒ])

recâ‚š : âˆ€ {Î“ C u v t}{Î“â‚š : Sub âˆ™ Î“ â†’ Set}{Câ‚š : Tm âˆ™ C â†’ Set}
     â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Câ‚š (u[Î½]))
     â†’ (âˆ€ {Î½} â†’ Î“â‚š (p âˆ˜ Î½) Ã— Câ‚š (q[Î½]) â†’ Câ‚š (v[Î½]))
     â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ PNat (t[Î½]))
     â†’ âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Câ‚š (rec (u[Î½]) (v[Î½âº]) (t[Î½]))
recâ‚š {Câ‚š = Câ‚š} uâ‚š vâ‚š tâ‚š Î³â‚š = Nat-Prec Câ‚š (uâ‚š Î³â‚š) (Î» câ‚š â†’ vâ‚š (Î³â‚š, câ‚š)) (tâ‚š Î³â‚š)

-- DTT, non-dependent eliminator

data PNat : Tm âˆ™ Nat â†’ Set where
  Pzero : PNat zero
  Psuc  : âˆ€ {t} â†’ PNat t â†’ PNat (suc t)

indPNat : âˆ€ {i}(P : âˆ€ {t} â†’ PNat t â†’ Set i)
	â†’ P Pzero
	â†’ (âˆ€ {t}{tâ‚š : PNat t} â†’ P tâ‚š â†’ P (Psuc tâ‚š))
	â†’ âˆ€ {t}(tâ‚š : PNat t) â†’ P tâ‚š
indPNat P uâ‚š vâ‚š Pzero     = uâ‚š
indPNat P uâ‚š vâ‚š (Psuc tâ‚š) = vâ‚š (indPNat P uâ‚š vâ‚š tâ‚š)

recPNat : âˆ€ {i}(C : Tm âˆ™ Nat â†’ Set i)
	â†’ C zero
	â†’ (âˆ€ {t} â†’ C t â†’ C (suc t))
	â†’ âˆ€ {t} â†’ PNat t â†’ C t
recPNat C uâ‚š vâ‚š tâ‚š = indPNat (Î» {t} _ â†’ C t) uâ‚š (Î» {t} _ â†’ vâ‚š t) tâ‚š

Nat-Prec : âˆ€ {i C}(Câ‚š : Tm âˆ™ C â†’ Set i)
	   {u : Tm âˆ™ C}{v : Tm (âˆ™ â–· C) (C[p])}{t : Tm âˆ™ Nat}
	 â†’ Câ‚š u
	 â†’ (âˆ€ {c} â†’ Câ‚š c â†’ Câ‚š (v[id, c]))
	 â†’ PNat t â†’ Câ‚š (rec u v t)
Nat-Prec Câ‚š {u}{v} uâ‚š vâ‚š tâ‚š = recPNat (Î» t â†’ Câ‚š (rec u v t)) uâ‚š vâ‚š tâ‚š

rec : âˆ€ {Î“ C} â†’ Tm Î“ C â†’ Tm (Î“ â–· C) (C[p]) â†’ Tm Î“ Nat â†’ Tm Î“ C
rec u v zero    = u
rec u v (suc t) = v[id, rec u v t]
(rec u v t)[Ïƒ] = rec (u[Ïƒ]) (v[Ïƒâº]) (t[Ïƒ])

recâ‚š : âˆ€ {i Î“ C u v t}{Î“â‚š : Sub âˆ™ Î“ â†’ Set}{Câ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (C[Î½]) â†’ Set i}
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š Î³â‚š (u[Î½]))
     â†’ (âˆ€ {Î½}(Î³câ‚š : Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ Câ‚š Î³â‚š (q[Î½]))) â†’ Câ‚š (projâ‚ Î³câ‚š) (v[Î½]))
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PNat (t[Î½]))
     â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š Î³â‚š (rec (u[Î½]) (v[Î½âº]) (t[Î½]))
recâ‚š {Câ‚š = Câ‚š} uâ‚š vâ‚š tâ‚š Î³â‚š = Nat-Prec (Câ‚š Î³â‚š) (uâ‚š Î³â‚š) (Î» câ‚š â†’ vâ‚š (Î³â‚š, câ‚š)) (tâ‚š Î³â‚š)

-- DTT, dependent eliminator

data PNat : Tm âˆ™ Nat â†’ Set where
  Pzero : PNat zero
  Psuc  : âˆ€ {t} â†’ PNat t â†’ PNat (suc t)

indPNat : âˆ€ {i}(P : âˆ€ {t} â†’ PNat t â†’ Set i)
	â†’ P Pzero
	â†’ (âˆ€ {t}{tâ‚š : PNat t} â†’ P tâ‚š â†’ P (Psuc tâ‚š))
	â†’ âˆ€ {t}(tâ‚š : PNat t) â†’ P tâ‚š
indPNat P uâ‚š vâ‚š Pzero     = uâ‚š
indPNat P uâ‚š vâ‚š (Psuc tâ‚š) = vâ‚š (indPNat P uâ‚š vâ‚š tâ‚š)

Nat-Pind : âˆ€ {i}{C : Ty (âˆ™ â–· Nat)}(Câ‚š : âˆ€ {t} â†’ PNat t â†’ Tm âˆ™ (C[id, t]) â†’ Set i)
	   {u : Tm âˆ™ (C[id, zero])}{v : Tm (âˆ™ â–· Nat â–· C) (C[pÂ², suc 1])}{t : Tm âˆ™ Nat}
	 â†’ Câ‚š Pzero u
	 â†’ (âˆ€ {t}{tâ‚š : PNat t}{c} â†’ Câ‚š tâ‚š c â†’ Câ‚š (Psuc tâ‚š) (v[id, t, c]))
	 â†’ (tâ‚š : PNat t) â†’ Câ‚š tâ‚š (ind C u v t)
Nat-Pind Câ‚š {u}{v} uâ‚š vâ‚š tâ‚š = indPNat (Î» {t} tâ‚š â†’ Câ‚š tâ‚š (ind C u v t)) uâ‚š vâ‚š tâ‚š

ind : âˆ€ {Î“}(C : Ty (Î“ â–· Nat))
    â†’ Tm Î“ (C[id, zero])
    â†’ Tm (Î“ â–· Nat â–· C) (C[pÂ², suc 1])
    â†’ (t : Tm Î“ Nat)
    â†’ Tm Î“ (C[id, t])
ind C u v zero    = u
ind C u v (suc t) = v[id, t, ind C u v t]
(ind C u v t)[Ïƒ] = ind (C[Ïƒâº]) (u[Ïƒ]) (v[Ïƒâºâº]) (t[Ïƒ])

Natâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ Nat â†’ Set
Natâ‚š = Î» _ â†’ PNat

zeroâ‚š : âˆ€ {Î“}{Î“â‚š : Sub âˆ™ Î“ â†’ Set}
      â†’ âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ PNat zero
zeroâ‚š = Î» _ â†’ Pzero

sucâ‚š : âˆ€ {Î“ t}{Î“â‚š : Sub âˆ™ Î“ â†’ Set}
     â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ PNat (t[Î½]))
     â†’ âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ PNat (suc (t[Î½]))
sucâ‚š tâ‚š = Î» Î³â‚š â†’ Psuc (tâ‚š Î³â‚š)

indâ‚š : âˆ€ {i Î“ C u v t}{Î“â‚š : Sub âˆ™ Î“ â†’ Set}
       {Câ‚š : âˆ€ {Î½} â†’ Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ PNat (q[Î½])) â†’ Tm âˆ™ (C[Î½]) â†’ Set i}
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, Pzero) (u[Î½]))
     â†’ (âˆ€ {Î½}(Î³tcâ‚š : Î£ (Î£ (Î“â‚š (pÂ² âˆ˜ Î½)) (Î» Î³â‚š â†’ PNat q[p âˆ˜ Î½])) (Î» Î³tâ‚š â†’ Câ‚š Î³tâ‚š (q[Î½])))
        â†’ Câ‚š (projâ‚ (projâ‚ Î³tcâ‚š), Psuc (projâ‚‚ (projâ‚ Î³tcâ‚š))) (v[Î½]))
     â†’ (tâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PNat (t[Î½]))
     â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, tâ‚š Î³â‚š) (ind (C[Î½âº]) (u[Î½]) (v[Î½âºâº]) (t[Î½]))
indâ‚š {Câ‚š = Câ‚š} uâ‚š vâ‚š tâ‚š {Î½} Î³â‚š = Nat-Pind (Î» {t} tâ‚š â†’ Câ‚š (Î³â‚š, tâ‚š))
  (uâ‚š Î³â‚š) (Î» {t}{tâ‚š}{c} câ‚š â†’ vâ‚š {Î½, t, c} (Î³â‚š, tâ‚š, câ‚š)) (tâ‚š Î³â‚š)

---------------------------------------------------------------------------------------------

------------------------------------
-- List
------------------------------------

List : âˆ€ {Î“} â†’ Ty Î“ â†’ Ty Î“
(List A)[Ïƒ] = List (A[Ïƒ])
nil : âˆ€ {Î“ A} â†’ Tm Î“ (List A)
nil[Ïƒ] = nil
cons : âˆ€ {Î“ A} â†’ Tm Î“ A â†’ Tm Î“ (List A) â†’ Tm Î“ (List A)
(cons t u)[Ïƒ] = cons (t[Ïƒ]) (u[Ïƒ])
ind : âˆ€ {Î“ A}(C : Ty (Î“ â–· List A))
    â†’ Tm Î“ (C[id, nil])
    â†’ Tm (Î“ â–· A â–· List (A[p]) â–· C[pÂ², 0]) (C[pÂ³, cons 2 1])
    â†’ (t : Tm Î“ (List A)) â†’ Tm Î“ (C[id, t])
(ind C u v t)[Ïƒ] = ind (C[Ïƒâº]) (u[Ïƒ]) (v[Ïƒâºâºâº]) (t[Ïƒ])
ind C u v nil        = u
ind C u v (cons a t) = v[id, a, t, ind C u v t]

data PList {i A}(Aâ‚š : Tm âˆ™ A â†’ Set i)
       : Tm âˆ™ (List A) â†’ Set where
  Pnil  : PList Aâ‚š nil
  Pcons : âˆ€ {a t} â†’ Aâ‚š a â†’ PList Aâ‚š t â†’ PList Aâ‚š (cons a t)

indPList : âˆ€ {i j A}{Aâ‚š : Tm âˆ™ A â†’ Set i}
	   (P : âˆ€ {t} â†’ PList Aâ‚š t â†’ Set j)
	 â†’ P Pnil
	 â†’ (âˆ€ {a t}(aâ‚š : Aâ‚š a){tâ‚š : PList Aâ‚š t} â†’ P tâ‚š â†’ P (Pcons aâ‚š tâ‚š))
	 â†’ âˆ€ {t}(tâ‚š : PList Aâ‚š t) â†’ P tâ‚š
indPList P uâ‚š vâ‚š Pnil          = uâ‚š
indPList P uâ‚š vâ‚š (Pcons aâ‚š tâ‚š) = vâ‚š aâ‚š (indPList P uâ‚š vâ‚š tâ‚š)

List-Pind : âˆ€ {i j A}{C : Ty j (âˆ™ â–· List A)}
	    {Aâ‚š : Tm âˆ™ A â†’ Set i}(Câ‚š : âˆ€ {t} â†’ PList Aâ‚š t â†’ Tm âˆ™ (C[id, t]) â†’ Set j)
	    {u : Tm âˆ™ (C[id, nil])}
	    {v : Tm (âˆ™ â–· A â–· List (A[p]) â–· C[pÂ², 0]) (C[pÂ³, cons 2 1])}
	    {t : Tm âˆ™ (List A)}
	  â†’ Câ‚š Pnil u
	  â†’ (âˆ€ {a t c}(aâ‚š : Aâ‚š a){tâ‚š : PList Aâ‚š t}
	     â†’ Câ‚š tâ‚š c â†’ Câ‚š (Pcons aâ‚š tâ‚š) (v[id, a, t, c]))
	  â†’ (tâ‚š : PList Aâ‚š t) â†’ Câ‚š tâ‚š (ind C u v t)
List-Pind Câ‚š {u}{v} uâ‚š vâ‚š tâ‚š =
  indPList (Î» {t} tâ‚š â†’ Câ‚š tâ‚š (ind C u v t))
           uâ‚š (Î» {a}{t} aâ‚š {tâ‚š} câ‚š â†’ vâ‚š {a}{t}{ind C u v t} aâ‚š {tâ‚š} câ‚š) tâ‚š

Listâ‚š : âˆ€ {x i Î“ A}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}
      â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i)
      â†’ âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (List (A[Î½])) â†’ Set
Listâ‚š Aâ‚š = Î» Î³â‚š â†’ PList (Aâ‚š Î³â‚š)

nilâ‚š : âˆ€ {x i Î“ A}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}
       {Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
     â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PList (Aâ‚š Î³â‚š) nil
nilâ‚š = Î» Î³â‚š â†’ Pnil

consâ‚š : âˆ€ {x i Î“ A a t}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}
      	{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
      â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Aâ‚š Î³â‚š (a[Î½]))
      â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PList (Aâ‚š Î³â‚š) (t[Î½]))
      â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PList (Aâ‚š Î³â‚š) (cons (a[Î½]) (t[Î½]))
consâ‚š aâ‚š tâ‚š = Î» Î³â‚š â†’ Pcons (aâ‚š Î³â‚š) (tâ‚š Î³â‚š)

indâ‚š : âˆ€ {x i j Î“ A}{C : Ty j (Î“ â–· List A)}
       {u : Tm Î“ (C[id, nil])}
       {v : Tm (Î“ â–· A â–· List (A[p]) â–· C[pÂ², 0]) (C[pÂ³, cons 2 1])}
       {t : Tm Î“ (List A)}
       {Î“â‚š : Sub âˆ™ Î“ â†’ Set x}{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
       (Câ‚š : âˆ€ {Î½} â†’ Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ PList (Aâ‚š Î³â‚š) (q[Î½]))
                   â†’ Tm âˆ™ (C[Î½]) â†’ Set j)
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, Pnil) (u[Î½]))
     â†’ (âˆ€ {Î½}(Î³atcâ‚š : Î£ (Î£ (Î£ (Î“â‚š (pÂ³ âˆ˜ Î½))
                              (Î» Î³â‚š â†’ Aâ‚š Î³â‚š (q[pÂ² âˆ˜ Î½])))
			      (Î» Î³aâ‚š â†’ PList (Aâ‚š (projâ‚ Î³aâ‚š)) (q[p âˆ˜ Î½])))
                              (Î» Î³atâ‚š â†’ Câ‚š (projâ‚ (projâ‚ Î³atâ‚š), projâ‚‚ Î³atâ‚š) (q[Î½])))
	     â†’ Câ‚š (projâ‚ (projâ‚ (projâ‚ Î³atcâ‚š)),
	           Pcons (projâ‚‚ (projâ‚ (projâ‚ Î³atcâ‚š))) (projâ‚‚ (projâ‚ Î³atcâ‚š))) (v[Î½]))
     â†’ (tâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PList (Aâ‚š Î³â‚š) (t[Î½]))
     â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, tâ‚š Î³â‚š) (ind (C[Î½âº]) (u[Î½]) (v[Î½âºâºâº]) (t[Î½]))
indâ‚š {u = u}{v} Câ‚š uâ‚š vâ‚š tâ‚š = Î» Î³â‚š â†’
  -- List-Pind {Aâ‚š = Aâ‚š Î³â‚š} (Î» tâ‚š â†’ Câ‚š (Î³â‚š, tâ‚š))
  --          (uâ‚š Î³â‚š) (Î» {a t c} aâ‚š {tâ‚š} câ‚š â†’ vâ‚š {Î½, a, t, c} (Î³â‚š, aâ‚š, tâ‚š, câ‚š)) (tâ‚š Î³â‚š)
  indPList {Aâ‚š = Aâ‚š Î³â‚š} (Î» {t} tâ‚š â†’ Câ‚š (Î³â‚š, tâ‚š) (ind (C[Î½âº]) (u[Î½]) (v[Î½âºâºâº]) t))
           (uâ‚š Î³â‚š)
           (Î» {a t} aâ‚š {tâ‚š} câ‚š
	      â†’ vâ‚š {Î½, a, t, ind (C[Î½âº]) (u[Î½]) (v[Î½âºâºâº]) t} (Î³â‚š, aâ‚š, tâ‚š, câ‚š))
	   (tâ‚š Î³â‚š)

------------------------------------
-- Vec v1
------------------------------------

Vec : âˆ€ {Î“} â†’ Ty j Î“ â†’ Ty j (Î“ â–· Nat)
(Vec A)[Ïƒâº] = Vec (A[Ïƒ])
nil : âˆ€ {Î“ A} â†’ Tm Î“ (Vec A[id, zero])
nil[Ïƒ] = nil
cons : âˆ€ {Î“ A} â†’ Tm Î“ A â†’ âˆ€ n â†’ Tm Î“ (Vec A[id, n]) â†’ Tm Î“ (Vec A[id, suc n])
(cons a n t)[Ïƒ] = cons (a[Ïƒ]) (n[Ïƒ]) (t[Ïƒ])
ind : âˆ€ {Î“ A}(C : Ty (Î“ â–· Nat â–· Vec A))
    â†’ Tm Î“ (C[id, zero, nil])
    â†’ Tm (Î“ â–· A â–· Nat â–· Vec A[pÂ², 0] â–· C[pÂ³, 1, 0]) (C[pâ´, suc 2, cons 3 2 1])
    â†’ âˆ€ n (t : Tm Î“ (Vec A[id, n])) â†’ Tm Î“ (C[id, n, t])
(ind C u v n t)[Ïƒ] = ind (C[Ïƒâºâº]) (u[Ïƒ]) (v[Ïƒâºâºâºâº]) (n[Ïƒ]) (t[Ïƒ])
ind C u v .zero    nil          = u
ind C u v .(suc n) (cons a n t) = v[id, a, n, t, ind C u v n t]

data PVec {i A}(Aâ‚š : Tm âˆ™ A â†’ Set i)
       : âˆ€ {n} â†’ PNat n â†’ Tm âˆ™ (Vec A[id, n]) â†’ Set where
  Pnil  : PVec Aâ‚š Pzero nil
  Pcons : âˆ€ {a n t} â†’ Aâ‚š a â†’ âˆ€ nâ‚š â†’ PVec Aâ‚š nâ‚š t â†’ PVec Aâ‚š (Psuc nâ‚š) (cons a n t)

indPVec : âˆ€ {i j A}{Aâ‚š : Tm âˆ™ A â†’ Set i}
	  (P : âˆ€ {n t}(nâ‚š : PNat n) â†’ PVec Aâ‚š nâ‚š t â†’ Set j)
	â†’ P Pzero Pnil
	â†’ (âˆ€ {a n t}(aâ‚š : Aâ‚š a)(nâ‚š : PNat n){tâ‚š : PVec Aâ‚š nâ‚š t}
	     â†’ P nâ‚š tâ‚š â†’ P (Psuc nâ‚š) (Pcons aâ‚š nâ‚š tâ‚š))
	â†’ âˆ€ {n t}(nâ‚š : PNat n)(tâ‚š : PVec Aâ‚š nâ‚š t) â†’ P nâ‚š tâ‚š
indPVec P uâ‚š vâ‚š .Pzero     Pnil             = uâ‚š
indPVec P uâ‚š vâ‚š .(Psuc nâ‚š) (Pcons aâ‚š nâ‚š tâ‚š) = vâ‚š aâ‚š nâ‚š (indPVec P uâ‚š vâ‚š nâ‚š tâ‚š)

Vecâ‚š : âˆ€ {x i Î“ A}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}
     â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i)
     â†’ âˆ€ {Î½} â†’ Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ PNat (q[Î½])) â†’ Tm âˆ™ (Vec A[Î½]) â†’ Set
Vecâ‚š Aâ‚š = Î» Î³nâ‚š â†’ PVec (Aâ‚š (pâ‚ Î³nâ‚š)) (pâ‚‚ Î³nâ‚š)

nilâ‚š : âˆ€ {x i Î“ A}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
     â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PVec (Aâ‚š Î³â‚š) Pzero nil
nilâ‚š = Î» Î³â‚š â†’ Pnil

consâ‚š : âˆ€ {x i Î“ A a n t}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
      â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Aâ‚š Î³â‚š (a[Î½]))
      â†’ (nâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PNat (n[Î½]))
      â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PVec (Aâ‚š Î³â‚š) (nâ‚š Î³â‚š) (t[Î½]))
      â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PVec (Aâ‚š Î³â‚š) (Psuc (nâ‚š Î³â‚š)) (cons (a[Î½]) (n[Î½]) (t[Î½]))
consâ‚š aâ‚š nâ‚š tâ‚š = Î» Î³â‚š â†’ Pcons (aâ‚š Î³â‚š) (nâ‚š Î³â‚š) (tâ‚š Î³â‚š)

indâ‚š : âˆ€ {x i j Î“ A C u v n t}
       {Î“â‚š : Sub âˆ™ Î“ â†’ Set x}{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
       (Câ‚š : âˆ€ {Î½}(Î³ntâ‚š : Î£ (Î£ (Î“â‚š (pÂ² âˆ˜ Î½))
                               (Î» Î³â‚š â†’ PNat (q[p âˆ˜ Î½])))
			       (Î» Î³nâ‚š â†’ PVec (Aâ‚š (pâ‚ Î³nâ‚š)) (pâ‚‚ Î³nâ‚š) (q[Î½])))
	          â†’ Tm âˆ™ (C[Î½]) â†’ Set j)
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, Pzero, Pnil) (u[Î½]))
     â†’ (âˆ€ {Î½}(Î³antcâ‚š : Î£ (Î£ (Î£ (Î£
                 (Î“â‚š (pâ´ âˆ˜ Î½))
		 (Î» Î³â‚š â†’ Aâ‚š Î³â‚š (q[pÂ³ âˆ˜ Î½])))
		 (Î» Î³aâ‚š â†’ PNat (q[pÂ² âˆ˜ Î½])))
		 (Î» Î³anâ‚š â†’ PVec (Aâ‚š (pâ‚ (pâ‚ Î³anâ‚š)) (pâ‚‚ Î³anâ‚š) (q[p âˆ˜ Î½]))))
		 (Î» Î³antâ‚š â†’ Câ‚š (pâ‚ (pâ‚ (pâ‚ Î³antâ‚š)), pâ‚‚ (pâ‚ Î³antâ‚š), pâ‚‚ Î³antâ‚š) (q[Î½])))
           â†’ Câ‚š (pâ‚ (pâ‚ (pâ‚ (pâ‚ Î³antâ‚š))),
	         Psuc (pâ‚‚ (pâ‚ (pâ‚ Î³antâ‚š))),
		 Pcons (pâ‚‚ (pâ‚ (pâ‚ (pâ‚ Î³antâ‚š)))) (pâ‚‚ (pâ‚ (pâ‚ Î³antâ‚š))) (pâ‚‚ (pâ‚ Î³antâ‚š))) (v[Î½]))
     â†’ (nâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PNat (n[Î½]))
     â†’ (tâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PVec (Aâ‚š Î³â‚š) (nâ‚š Î³â‚š) (t[Î½]))
     â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, nâ‚š Î³â‚š, tâ‚š Î³â‚š) (ind (C[Î½âºâº]) (u[Î½]) (v[Î½âºâºâºâº]) (n[Î½]) (t[Î½]))
indâ‚š {Aâ‚š = Aâ‚š} Câ‚š uâ‚š vâ‚š nâ‚š tâ‚š = Î» {Î½} Î³â‚š â†’
  indPVec {A = A[Î½]}{Aâ‚š = Aâ‚š Î³â‚š}
          (Î» {n}{t} nâ‚š tâ‚š â†’ Câ‚š {Î½, n, t} (Î³â‚š, nâ‚š, tâ‚š) (ind (C[Î½âºâº]) (u[Î½]) (v[Î½âºâºâºâº]) n t))
	  (uâ‚š Î³â‚š)
	  (Î» {a}{n}{t} aâ‚š nâ‚š {tâ‚š} câ‚š â†’
	     vâ‚š {Î½, a, n, t, ind (C[Î½âºâº]) (u[Î½]) (v[Î½âºâºâºâº]) n t} (Î³â‚š, aâ‚š, nâ‚š, tâ‚š, câ‚š))
	  (nâ‚š Î³â‚š) (tâ‚š Î³â‚š)

------------------------------------
-- Vec v2
------------------------------------

Vec : âˆ€ {Î“} â†’ Ty j Î“ â†’ Tm Î“ Nat â†’ Ty j Î“
(Vec A n)[Ïƒ] = Vec (A[Ïƒ]) (n[Ïƒ])
nil : âˆ€ {Î“ A} â†’ Tm Î“ (Vec A zero)
nil[Ïƒ] = nil
cons : âˆ€ {Î“ A} â†’ Tm Î“ A â†’ âˆ€ n â†’ Tm Î“ (Vec A n) â†’ Tm Î“ (Vec A (suc n))
(cons a n t)[Ïƒ] = cons (a[Ïƒ]) (n[Ïƒ]) (t[Ïƒ])
ind : âˆ€ {Î“ A}(C : Ty (Î“ â–· Nat â–· Vec (A[p]) 0))
    â†’ Tm Î“ (C[id, zero, nil])
    â†’ Tm (Î“ â–· A â–· Nat â–· Vec (A[pÂ²]) 0 â–· C[pÂ³, 1, 0]) (C[pâ´, suc 2, cons 3 2 1])
    â†’ âˆ€ n (t : Tm Î“ (Vec A n)) â†’ Tm Î“ (C[id, n, t])
(ind C u v n t)[Ïƒ] = ind (C[Ïƒâºâº]) (u[Ïƒ]) (v[Ïƒâºâºâºâº]) (n[Ïƒ]) (t[Ïƒ])
ind C u v .zero    nil          = u
ind C u v .(suc n) (cons a n t) = v[id, a, n, t, ind C u v n t]

data PVec {i A}(Aâ‚š : Tm âˆ™ A â†’ Set i)
       : âˆ€ {n} â†’ PNat n â†’ Tm âˆ™ (Vec A n) â†’ Set where
  Pnil  : PVec Aâ‚š Pzero nil
  Pcons : âˆ€ {a n t} â†’ Aâ‚š a â†’ âˆ€ nâ‚š â†’ PVec Aâ‚š nâ‚š t â†’ PVec Aâ‚š (Psuc nâ‚š) (cons a n t)

indPVec : âˆ€ {i j A}{Aâ‚š : Tm âˆ™ A â†’ Set i}
	  (P : âˆ€ {n t}(nâ‚š : PNat n) â†’ PVec Aâ‚š nâ‚š t â†’ Set j)
	â†’ P Pzero Pnil
	â†’ (âˆ€ {a n t}(aâ‚š : Aâ‚š a)(nâ‚š : PNat n){tâ‚š : PVec Aâ‚š nâ‚š t}
	     â†’ P nâ‚š tâ‚š â†’ P (Psuc nâ‚š) (Pcons aâ‚š nâ‚š tâ‚š))
	â†’ âˆ€ {n t}(nâ‚š : PNat n)(tâ‚š : PVec Aâ‚š nâ‚š t) â†’ P nâ‚š tâ‚š
indPVec P uâ‚š vâ‚š .Pzero     Pnil             = uâ‚š
indPVec P uâ‚š vâ‚š .(Psuc nâ‚š) (Pcons aâ‚š nâ‚š tâ‚š) = vâ‚š aâ‚š nâ‚š (indPVec P uâ‚š vâ‚š nâ‚š tâ‚š)

Vecâ‚š : âˆ€ {x i Î“ A n}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}
     â†’ (âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i)
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PNat (n[Î½]))
     â†’ âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (Vec (A[Î½]) (n[Î½])) â†’ Set
Vecâ‚š Aâ‚š nâ‚š = Î» Î³â‚š â†’ PVec (Aâ‚š Î³â‚š) (nâ‚š Î³â‚š)

nilâ‚š : âˆ€ {x i Î“ A}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
     â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PVec (Aâ‚š Î³â‚š) Pzero nil
nilâ‚š = Î» Î³â‚š â†’ Pnil

consâ‚š : âˆ€ {x i Î“ A a n t}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
      â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Aâ‚š Î³â‚š (a[Î½]))
      â†’ (nâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PNat (n[Î½]))
      â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PVec (Aâ‚š Î³â‚š) (nâ‚š Î³â‚š) (t[Î½]))
      â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PVec (Aâ‚š Î³â‚š) (Psuc (nâ‚š Î³â‚š)) (cons (a[Î½]) (n[Î½]) (t[Î½]))
consâ‚š aâ‚š nâ‚š tâ‚š = Î» Î³â‚š â†’ Pcons (aâ‚š Î³â‚š) (nâ‚š Î³â‚š) (tâ‚š Î³â‚š)

indâ‚š : âˆ€ {x i j Î“ A C u v n t}
       {Î“â‚š : Sub âˆ™ Î“ â†’ Set x}{Aâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (A[Î½]) â†’ Set i}
       (Câ‚š : âˆ€ {Î½}(Î³ntâ‚š : Î£ (Î£ (Î“â‚š (pÂ² âˆ˜ Î½))
                               (Î» Î³â‚š â†’ PNat (q[p âˆ˜ Î½])))
			       (Î» Î³nâ‚š â†’ PVec (Aâ‚š (pâ‚ Î³nâ‚š)) (pâ‚‚ Î³nâ‚š) (q[Î½])))
	          â†’ Tm âˆ™ (C[Î½]) â†’ Set j)
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, Pzero, Pnil) (u[Î½]))
     â†’ (âˆ€ {Î½}(Î³antcâ‚š : Î£ (Î£ (Î£ (Î£
                 (Î“â‚š (pâ´ âˆ˜ Î½))
		 (Î» Î³â‚š â†’ Aâ‚š Î³â‚š (q[pÂ³ âˆ˜ Î½])))
		 (Î» Î³aâ‚š â†’ PNat (q[pÂ² âˆ˜ Î½])))
		 (Î» Î³anâ‚š â†’ PVec (Aâ‚š (pâ‚ (pâ‚ Î³anâ‚š)) (pâ‚‚ Î³anâ‚š) (q[p âˆ˜ Î½]))))
		 (Î» Î³antâ‚š â†’ Câ‚š (pâ‚ (pâ‚ (pâ‚ Î³antâ‚š)), pâ‚‚ (pâ‚ Î³antâ‚š), pâ‚‚ Î³antâ‚š) (q[Î½])))
           â†’ Câ‚š (pâ‚ (pâ‚ (pâ‚ (pâ‚ Î³antâ‚š))),
	         Psuc (pâ‚‚ (pâ‚ (pâ‚ Î³antâ‚š))),
		 Pcons (pâ‚‚ (pâ‚ (pâ‚ (pâ‚ Î³antâ‚š)))) (pâ‚‚ (pâ‚ (pâ‚ Î³antâ‚š))) (pâ‚‚ (pâ‚ Î³antâ‚š))) (v[Î½]))
     â†’ (nâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PNat (n[Î½]))
     â†’ (tâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PVec (Aâ‚š Î³â‚š) (nâ‚š Î³â‚š) (t[Î½]))
     â†’ âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, nâ‚š Î³â‚š, tâ‚š Î³â‚š) (ind (C[Î½âºâº]) (u[Î½]) (v[Î½âºâºâºâº]) (n[Î½]) (t[Î½]))
indâ‚š {Aâ‚š = Aâ‚š} Câ‚š uâ‚š vâ‚š nâ‚š tâ‚š = Î» {Î½} Î³â‚š â†’
  indPVec {A = A[Î½]}{Aâ‚š = Aâ‚š Î³â‚š}
          (Î» {n}{t} nâ‚š tâ‚š â†’ Câ‚š {Î½, n, t} (Î³â‚š, nâ‚š, tâ‚š) (ind (C[Î½âºâº]) (u[Î½]) (v[Î½âºâºâºâº]) n t))
	  (uâ‚š Î³â‚š)
	  (Î» {a}{n}{t} aâ‚š nâ‚š {tâ‚š} câ‚š â†’
	     vâ‚š {Î½, a, n, t, ind (C[Î½âºâº]) (u[Î½]) (v[Î½âºâºâºâº]) n t} (Î³â‚š, aâ‚š, nâ‚š, tâ‚š, câ‚š))
	  (nâ‚š Î³â‚š) (tâ‚š Î³â‚š)

------------------------------------
-- W
------------------------------------

data W (I : Set a)(S : I â†’ Set b)(P : (i : I) â†’ S i â†’ I â†’ Set c) : I â†’ Set (a âŠ” b âŠ” c) where
  sup : (i : I)(s : S i) â†’ ((j : I) â†’ P i s j â†’ W I S P j) â†’ W I S P i

indW : âˆ€ {a b c d}{I : Set a}{S : I â†’ Set b}{P : (i : I) â†’ S i â†’ I â†’ Set c}
      (C : (i : I) â†’ W I S P i â†’ Set d)
    â†’ ((i : I)(s : S i)(f : (j : I) â†’ P i s j â†’ W I S P j)
       â†’ ((j : I)(p : P i s j) â†’ C j (f j p)) â†’ C i (sup i s f))
    â†’ (i : I)(w : W I S P i) â†’ C i w
indW C v .i (sup i s f) = v i s f (Î» j p â†’ indW C v j (f j p))

W : âˆ€ {Î“}(I : Ty a Î“)(S : Ty b (Î“ â–· I)) â†’ Ty c (Î“ â–· I â–· S â–· I[pÂ²]) â†’ Ty (a âŠ” b âŠ” c) (Î“ â–· I)
(W I S P)[Ïƒâº] = W (I[Ïƒ]) (S[Ïƒâº]) (P[Ïƒâºâºâº])
sup : âˆ€ {Î“ I S P}
      (i : Tm Î“ I)(s : Tm Î“ (S[id, i]))
    â†’ Tm Î“ (Î  I (P[(id, i, s)âº] â‡’ W I S P))
    â†’ Tm Î“ (W I S P[id, i])
(sup i s f)[Ïƒ] = sup (i[Ïƒ]) (s[Ïƒ]) (f[Ïƒ])
ind : âˆ€ {Î“ I S P}(C : Ty d (Î“ â–· I â–· W I S P))
    â†’ Tm (Î“ â–· I â–· S â–· Î  (I[pÂ²]) (P â‡’ W I S P[(pÂ²)âº])
            â–· Î  (I[pÂ³]) (Î  (P[pâº]) (C[pâµ, 1, 2 $ 1 $ 0]))) (C[pÂ³, sup 3 2 1])
    â†’ (i : Tm Î“ I)(w : Tm Î“ (W I S P[id, i])) â†’ Tm Î“ (C[id, i, w])
(ind C v i w)[Ïƒ] = ind (C[Ïƒâºâº]) (v[Ïƒâºâºâºâº]) (i[Ïƒ]) (w[Ïƒ])
ind C v .i (sup i s f) = v[id, i, s, f, lam (lam (ind (C[(pÂ²)âºâº]) (v[(pÂ²)âºâºâºâº]) 1 (f[pÂ²] $ 1 $ 0)))]

data PW {a b c}{I : Ty a âˆ™}{S : Ty b (âˆ™ â–· I)}{P : Ty c (âˆ™ â–· I â–· S â–· I[pÂ²])}
     	(Iâ‚š : Tm âˆ™ I â†’ Set a)(Sâ‚š : âˆ€ {i} â†’ Iâ‚š i â†’ Tm âˆ™ (S[id, i]) â†’ Set b)
	(Pâ‚š : âˆ€ {i s j}(iâ‚š : Iâ‚š i) â†’ Sâ‚š iâ‚š s â†’ Iâ‚š j â†’ Tm âˆ™ (P[id, i, s, j]) â†’ Set c)
	: âˆ€ {i} â†’ Iâ‚š i â†’ Tm âˆ™ (W I S P[id, i]) â†’ Set (a âŠ” b âŠ” c) where
  Psup : âˆ€ {i s f}(iâ‚š : Iâ‚š i)(sâ‚š : Sâ‚š iâ‚š s)
       â†’ (âˆ€ {j p}(jâ‚š : Iâ‚š j) â†’ Pâ‚š iâ‚š sâ‚š jâ‚š p â†’ PW Iâ‚š Sâ‚š Pâ‚š jâ‚š (f $ j $ p))
       â†’ PW Iâ‚š Sâ‚š Pâ‚š iâ‚š (sup i s f)

indPW : âˆ€ {a b c d}{I : Ty a âˆ™}{S : Ty b (âˆ™ â–· I)}{P : Ty c (âˆ™ â–· I â–· S â–· I[pÂ²])}
        {Iâ‚š : Tm âˆ™ I â†’ Set a}{Sâ‚š : âˆ€ {i} â†’ Iâ‚š i â†’ Tm âˆ™ (S[id, i]) â†’ Set b}
	{Pâ‚š : âˆ€ {i s j}(iâ‚š : Iâ‚š i) â†’ Sâ‚š iâ‚š s â†’ Iâ‚š j â†’ Tm âˆ™ (P[id, i, s, j]) â†’ Set c}
        (C : âˆ€ {i w}(iâ‚š : Iâ‚š i) â†’ PW Iâ‚š Sâ‚š Pâ‚š iâ‚š w â†’ Set d)
      â†’ (âˆ€ {i s f}(iâ‚š : Iâ‚š i)(sâ‚š : Sâ‚š iâ‚š s)
           {fâ‚š : âˆ€ {j p}(jâ‚š : Iâ‚š j) â†’ Pâ‚š iâ‚š sâ‚š jâ‚š p â†’ PW Iâ‚š Sâ‚š Pâ‚š jâ‚š (f $ j $ p)}
	 â†’ (âˆ€ {j p}(jâ‚š : Iâ‚š j)(pâ‚š : Pâ‚š iâ‚š sâ‚š jâ‚š p) â†’ C jâ‚š (fâ‚š jâ‚š pâ‚š))
	 â†’ C iâ‚š (Psup iâ‚š sâ‚š fâ‚š))
      â†’ âˆ€ {i w}(iâ‚š : Iâ‚š i)(wâ‚š : PW Iâ‚š Sâ‚š Pâ‚š iâ‚š w) â†’ C iâ‚š wâ‚š
indPW C vâ‚š .iâ‚š (Psup iâ‚š sâ‚š fâ‚š) = vâ‚š iâ‚š sâ‚š fâ‚š (Î» jâ‚š pâ‚š â†’ indPW C vâ‚š jâ‚š (fâ‚š jâ‚š pâ‚š))

Wâ‚š : âˆ€ {Î“ I S P}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}
     (Iâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (I[Î½]) â†’ Set a)
     (Sâ‚š : âˆ€ {Î½} â†’ Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ Iâ‚š Î³â‚š (q[Î½])) â†’ Tm âˆ™ (S[Î½]) â†’ Set b)
   â†’ (âˆ€ {Î½} â†’ Î£ (Î£ (Î£
        (Î“â‚š (pÂ³ âˆ˜ Î½))
	(Î» Î³â‚š â†’ Iâ‚š Î³â‚š (q[pÂ² âˆ˜ Î½])))
	(Î» Î³iâ‚š â†’ Sâ‚š Î³iâ‚š (q[p âˆ˜ Î½])))
	(Î» Î³isâ‚š â†’ Iâ‚š (pâ‚ (pâ‚ Î³isâ‚š)) (q[Î½]))
      â†’ Tm âˆ™ (P[Î½]) â†’ Set c)
   â†’ (âˆ€ {Î½} â†’ Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ Iâ‚š Î³â‚š (q[Î½])) â†’ Tm âˆ™ (W I S P[Î½]) â†’ Set (a âŠ” b âŠ” c))
Wâ‚š Iâ‚š Sâ‚š Pâ‚š = Î» Î³iâ‚š â†’
  PW (Iâ‚š (pâ‚ Î³iâ‚š)) (Î» iâ‚š â†’ Sâ‚š (pâ‚ Î³iâ‚š, iâ‚š)) (Î» iâ‚š sâ‚š jâ‚š â†’ Pâ‚š (pâ‚ Î³iâ‚š, iâ‚š, sâ‚š, jâ‚š)) (pâ‚‚ Î³iâ‚š)

supâ‚š : âˆ€ {Î“ I S P i s f}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}
         {Iâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (I[Î½]) â†’ Set a}
	 {Sâ‚š : âˆ€ {Î½} â†’ Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ Iâ‚š Î³â‚š (q[Î½])) â†’ Tm âˆ™ (S[Î½]) â†’ Set b}
	 {Pâ‚š : âˆ€ {Î½} â†’ Î£ (Î£ (Î£
	         (Î“â‚š (pÂ³ âˆ˜ Î½))
	         (Î» Î³â‚š â†’ Iâ‚š Î³â‚š (q[pÂ² âˆ˜ Î½])))
	         (Î» Î³iâ‚š â†’ Sâ‚š Î³iâ‚š (q[p âˆ˜ Î½])))
	         (Î» Î³isâ‚š â†’ Iâ‚š (pâ‚ (pâ‚ Î³isâ‚š)) (q[Î½]))
	       â†’ Tm âˆ™ (P[Î½]) â†’ Set c}
     â†’ (iâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Iâ‚š Î³â‚š (i[Î½]))
     â†’ (sâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Sâ‚š (Î³â‚š, iâ‚š Î³â‚š) (s[Î½]))
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½)
        â†’ âˆ€ {j}(jâ‚š : Iâ‚š Î³â‚š j)
	â†’ âˆ€ {p} â†’ Pâ‚š (Î³â‚š, iâ‚š Î³â‚š, sâ‚š Î³â‚š, jâ‚š) p
	â†’ PW (Iâ‚š Î³â‚š) (Î» iâ‚š â†’ Sâ‚š (Î³â‚š, iâ‚š)) (Î» iâ‚š sâ‚š jâ‚š â†’ Pâ‚š (Î³â‚š, iâ‚š, sâ‚š, jâ‚š))
	     jâ‚š (f[Î½] $ j $ p))
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½)
        â†’ PW (Iâ‚š Î³â‚š) (Î» iâ‚š â†’ Sâ‚š (Î³â‚š, iâ‚š)) (Î» iâ‚š sâ‚š jâ‚š â†’ Pâ‚š (Î³â‚š, iâ‚š, sâ‚š, jâ‚š))
	     (iâ‚š Î³â‚š) (sup (i[Î½]) (s[Î½]) (f[Î½])))
supâ‚š iâ‚š sâ‚š fâ‚š = Î» Î³â‚š â†’ Psup (iâ‚š Î³â‚š) (sâ‚š Î³â‚š) (Î» {j}{p} jâ‚š pâ‚š â†’ fâ‚š Î³â‚š {j} jâ‚š {p} pâ‚š)

indâ‚š : âˆ€ {Î“ I S P C v i w}{Î“â‚š : Sub âˆ™ Î“ â†’ Set x}
       {Iâ‚š : âˆ€ {Î½} â†’ Î“â‚š Î½ â†’ Tm âˆ™ (I[Î½]) â†’ Set a}
       {Sâ‚š : âˆ€ {Î½} â†’ Î£ (Î“â‚š (p âˆ˜ Î½)) (Î» Î³â‚š â†’ Iâ‚š Î³â‚š (q[Î½])) â†’ Tm âˆ™ (S[Î½]) â†’ Set b}
       {Pâ‚š : âˆ€ {Î½} â†’ Î£ (Î£ (Î£
	       (Î“â‚š (pÂ³ âˆ˜ Î½))
	       (Î» Î³â‚š â†’ Iâ‚š Î³â‚š (q[pÂ² âˆ˜ Î½])))
	       (Î» Î³iâ‚š â†’ Sâ‚š Î³iâ‚š (q[p âˆ˜ Î½])))
	       (Î» Î³isâ‚š â†’ Iâ‚š (pâ‚ (pâ‚ Î³isâ‚š)) (q[Î½]))
	     â†’ Tm âˆ™ (P[Î½]) â†’ Set c}
       (Câ‚š : âˆ€ {Î½} â†’ Î£ (Î£
               (Î“â‚š (pÂ² âˆ˜ Î½))
	       (Î» Î³â‚š â†’ Iâ‚š Î³â‚š (q[p âˆ˜ Î½])))
	       (Î» Î³iâ‚š â†’ PW (Iâ‚š (pâ‚ Î³iâ‚š)) (Î» iâ‚š â†’ Sâ‚š (pâ‚ Î³iâ‚š, iâ‚š))
	                   (Î» iâ‚š sâ‚š jâ‚š â†’ Pâ‚š (pâ‚ Î³iâ‚š, iâ‚š, sâ‚š, jâ‚š)) (pâ‚‚ Î³iâ‚š) (q[Î½]))
	   â†’ Tm âˆ™ (C[Î½]) â†’ Set d)
     â†’ (âˆ€ {Î½}(Î³isfcâ‚š : Î£ (Î£ (Î£ (Î£
          (Î“â‚š (pâ´ âˆ˜ Î½))
	  (Î» Î³â‚š â†’ Iâ‚š Î³â‚š (q[pÂ³ âˆ˜ Î½])))
	  (Î» Î³iâ‚š â†’ Sâ‚š Î³iâ‚š (q[pÂ² âˆ˜ Î½])))
	  (Î» Î³isâ‚š â†’ âˆ€ {j}(jâ‚š : Iâ‚š (pâ‚ (pâ‚ Î³isâ‚š)) j)
	          â†’ âˆ€ {p} â†’ Pâ‚š (Î³isâ‚š, jâ‚š) p
		  â†’ PW (Iâ‚š (pâ‚ (pâ‚ Î³isâ‚š))) (Î» iâ‚š â†’ Sâ‚š (pâ‚ (pâ‚ Î³isâ‚š), iâ‚š))
		       (Î» iâ‚š sâ‚š jâ‚š â†’ Pâ‚š (pâ‚ (pâ‚ Î³isâ‚š), iâ‚š, sâ‚š, jâ‚š)) jâ‚š (q[p âˆ˜ Î½] $ j $ p)))
          (Î» Î³isfâ‚š â†’ âˆ€ {j}(jâ‚š : Iâ‚š (pâ‚ (pâ‚ (pâ‚ Î³isfâ‚š))) j)
	           â†’ âˆ€ {p}(pâ‚š : Pâ‚š (pâ‚ Î³isfâ‚š, jâ‚š) p)
		   â†’ Câ‚š (pâ‚ (pâ‚ (pâ‚ Î³isfâ‚š)), jâ‚š, pâ‚‚ Î³isfâ‚š jâ‚š pâ‚š) (q[Î½] $ j $ p)))
        â†’ Câ‚š (pâ‚ (pâ‚ (pâ‚ Î³isfcâ‚š)), Psup (pâ‚‚ (pâ‚ (pâ‚ (pâ‚ Î³isfcâ‚š))))
	                                (pâ‚‚ (pâ‚ (pâ‚ Î³isfcâ‚š)))
					(Î» {j}{p} jâ‚š pâ‚š â†’ pâ‚‚ (pâ‚ Î³isfcâ‚š) {j} jâ‚š {p} pâ‚š)) (v[Î½]))
     â†’ (iâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Iâ‚š Î³â‚š (i[Î½]))
     â†’ (wâ‚š : âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ PW (Iâ‚š Î³â‚š) (Î» iâ‚š â†’ Sâ‚š (Î³â‚š, iâ‚š))
                                   (Î» iâ‚š sâ‚š jâ‚š â†’ Pâ‚š (Î³â‚š, iâ‚š, sâ‚š, jâ‚š)) (iâ‚š Î³â‚š) (w[Î½]))
     â†’ (âˆ€ {Î½}(Î³â‚š : Î“â‚š Î½) â†’ Câ‚š (Î³â‚š, iâ‚š Î³â‚š, wâ‚š Î³â‚š) (ind (C[Î½âºâº]) (v[Î½âºâºâºâº]) (i[Î½]) (w[Î½])))
indâ‚š {C = C}{v} Câ‚š vâ‚š iâ‚š wâ‚š = Î» {Î½} Î³â‚š â†’
  indPW {I[Î½]}{S[Î½âº]}{P[Î½âºâºâº]}{Iâ‚š Î³â‚š}{Î» iâ‚š â†’ Sâ‚š (Î³â‚š, iâ‚š)}{Î» iâ‚š sâ‚š jâ‚š â†’ Pâ‚š (Î³â‚š, iâ‚š, sâ‚š, jâ‚š)}
        (Î» {i}{w} iâ‚š wâ‚š â†’ Câ‚š (Î³â‚š, iâ‚š, wâ‚š) (ind (C[Î½âºâº]) (v[Î½âºâºâºâº]) i w))
	(Î» iâ‚š sâ‚š {fâ‚š} câ‚š â†’ vâ‚š (Î³â‚š, iâ‚š, sâ‚š, Î» {j} jâ‚š {p} pâ‚š â†’ fâ‚š {j}{p} jâ‚š pâ‚š,
	                                   Î» {j} jâ‚š {p} pâ‚š â†’ câ‚š {j}{p} jâ‚š pâ‚š))
	(iâ‚š Î³â‚š) (wâ‚š Î³â‚š)

Goal: Câ‚š (Î³â‚š, iâ‚š, Psup iâ‚š sâ‚š fâ‚š)
         (v[Î½, i, s, f, lam (lam (ind (C[(Î½ âˆ˜ pÂ²)âºâº]) (v[(Î½ âˆ˜ pÂ²)âºâºâºâº]) 1 (f[pÂ²] $ 1 $ 0)))])
Goal: Câ‚š (Î³â‚š, jâ‚š, fâ‚š jâ‚š pâ‚š) (ind (C[Î½âºâº]) (v[Î½âºâºâºâº]) j (f $ j $ p))

t $ u $ v = app t[id, u] $ v = app (app t[id, u])[id, v] = app (app t)[(id, u)âº][id, v] =
          = app (app t)[id, u, v]

I  : Ty a âˆ™
Iâ‚š : Tyâ‚š a âˆ™â‚š I
   = âˆ€ (Î½ : Sub âˆ™ âˆ™) â†’ ğŸ™ â†’ Tm âˆ™ (I[Î½]) â†’ Set a
   â‰… Tm âˆ™ I â†’ Set a
S  : Ty b (âˆ™ â–· I)
Sâ‚š : Tyâ‚š b (âˆ™â‚š â–·â‚š Iâ‚š) S
   = âˆ€ (Î½ : Sub âˆ™ (âˆ™ â–· I)) â†’ Î£ ğŸ™ (Î» dâ‚š â†’ Iâ‚š (p âˆ˜ Î½) dâ‚š (q[Î½])) â†’ Tm âˆ™ (S[Î½]) â†’ Set b
   â‰… âˆ€ (i : Tm âˆ™ I) â†’ Iâ‚š i â†’ Tm âˆ™ (S[id, i]) â†’ Set b

P  : Ty c (âˆ™ â–· I â–· S â–· I[pÂ²])
Pâ‚š : Tyâ‚š c (âˆ™â‚š â–·â‚š Iâ‚š â–· Sâ‚š â–· Iâ‚š[pâ‚šÂ²]â‚š) P
   = âˆ€ (Î½ : Sub âˆ™ (âˆ™ â–· I â–· S â–· I[pÂ²]))
     â†’ Î£ (Î£ (Î£ ğŸ™
            (Î» dâ‚š â†’ Iâ‚š (pÂ³ âˆ˜ Î½) dâ‚š (q[pÂ² âˆ˜ Î½])))
            (Î» diâ‚š â†’ Sâ‚š (pÂ² âˆ˜ Î½) diâ‚š (q[p âˆ˜ Î½])))
	    (Î» disâ‚š â†’ Iâ‚š (pÂ³ âˆ˜ Î½) (pâ‚ (pâ‚ disâ‚š)) (q[Î½]))
     â†’ Tm âˆ™ (P[Î½]) â†’ Set c
   â‰… âˆ€ (i : Tm âˆ™ I)(s : Tm âˆ™ (S[id, i]))(j : Tm âˆ™ I)
     â†’ (dâ‚š : ğŸ™)(iâ‚š : Iâ‚š id dâ‚š i)(sâ‚š : Sâ‚š (id, i) (dâ‚š, iâ‚š) s)(jâ‚š : Iâ‚š id dâ‚š j)
     â†’ Tm âˆ™ (P[id, i, s, j]) â†’ Set c
   â‰… âˆ€ (i : Tm âˆ™ I)(s : Tm âˆ™ (S[id, i]))(j : Tm âˆ™ I)
     â†’ (iâ‚š : Iâ‚š i) â†’ Sâ‚š i iâ‚š s â†’ Iâ‚š j â†’ Tm âˆ™ (P[id, i, s, j]) â†’ Set c
